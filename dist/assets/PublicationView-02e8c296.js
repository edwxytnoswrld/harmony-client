import{d as z,r as u,a as E,i as P,V as g,e as h,o as i,c,b as e,j as f,t as p,k as r,h as y,X as N,l as S,m as T,n as L,p as q,w as A,v as X,F as J,q as K,f as G}from"./index-f45010d8.js";const H={class:"reply"},Q={class:"d-flex mb-3"},W=["src"],Y={class:"ms-2 d-flex flex-column justify-content-center"},Z={class:"ms-auto"},ee={class:"d-flex align-items-center"},te={class:"d-flex align-items-center me-4"},se={class:"align-middle",style:{"line-height":"1.5rem"}},le=z({__name:"Reply",props:["reply"],setup(m){const o=m,a="https://harmony.northeurope.cloudapp.azure.com",x=u("user-photos/0/default.png"),{cookies:v}=E(),t=u(v.get("token")),k=u(!1);let _={headers:{Authorization:"Bearer "+t.value}};console.log(o.reply),o.reply.avatarUrl!=null&&(x.value=o.reply.avatarUrl),P(()=>{C()});function b(){y.push({path:"/user/"+o.reply.userId})}function C(){let d=g.decode(t.value).userId;h.get(a+"/api/replies/is-liked?replyId="+o.reply.id+"&userId="+d,_).then(function(n){k.value=n.data}).catch(function(n){console.log(n)})}function U(){const d=new FormData;d.append("userId",g.decode(t.value).userId),d.append("replyId",o.reply.id),h.post(a+"/api/replies/like",d,_).then(function(n){console.log(n.data),y.go(0)}).catch(function(n){console.log(n)})}function I(){const d=new FormData;d.append("userId",g.decode(t.value).userId),d.append("replyId",o.reply.id),h.post(a+"/api/replies/unlike",d,_).then(function(n){console.log(n.data),y.go(0)}).catch(function(n){console.log(n)})}return(d,n)=>(i(),c("div",H,[e("div",Q,[e("img",{src:f(a)+"/api/"+x.value,alt:"",width:"75",height:"75",class:"rounded-circle me-2 object-fit-cover pointer",onClick:b},null,8,W),e("div",Y,[e("strong",{class:"pointer",onClick:b},p(m.reply.name),1),e("div",{class:"align-items-center pointer",onClick:b},"@"+p(m.reply.username),1)]),e("div",Z,p(m.reply.createdDate),1)]),e("p",null,p(m.reply.content),1),e("div",ee,[e("div",te,[k.value?r("",!0):(i(),c("i",{key:0,class:"bi bi-heart me-3 align-middle pointer",style:{"font-size":"1.5rem"},onClick:U})),k.value?(i(),c("i",{key:1,class:"bi bi-heart-fill me-3 align-middle pointer",style:{"font-size":"1.5rem"},onClick:I})):r("",!0),e("span",se,p(m.reply.likeCount),1)])])]))}});const oe={class:"ms-5 bg-light",id:"wrapper"},ne={class:"top-bar",style:{"padding-left":"15px"}},ae=e("span",{class:"align-middle",style:{"line-height":"1.5rem"}},"Publicējums",-1),ie={class:"content-bar"},ce={class:"d-flex mb-3"},de=["src"],re={class:"ms-2 d-flex flex-column justify-content-center"},ue={class:"ms-auto"},pe={class:"m-0"},me={key:0,class:"container w-100 mw-100 p-0 m-0"},he={class:"row w-100 align-items-center p-0 text-start m-0",style:{width:"50%","margin-left":"0px","margin-right":"0px","max-width":"50%"}},ve={class:"col p-0"},_e=["src"],fe={class:"col pt-2 ms-3"},ge={key:0},ye=e("div",{class:"accordion",id:"accordionExample",style:{"border-radius":"15px !important"}},[e("div",{class:"accordion-item"},[e("h2",{class:"accordion-header",id:"headingOne"},[e("button",{class:"accordion-button collapsed",type:"button","data-bs-toggle":"collapse","data-bs-target":"#collapseOne","aria-expanded":"true","aria-controls":"collapseOne"}," Skatīt datus ")])])],-1),ke=[ye],be={key:1,id:"collapseOne",class:"accordion-collapse collapse","aria-labelledby":"headingOne","data-bs-parent":"#accordionExample"},Ie={class:"accordion-body"},xe={style:{"white-space":"pre"},class:"mb-1 mt-2"},Ue=["id"],we={key:2,class:"d-flex align-items-center mt-2"},Ce=e("i",{class:"bi bi-download me-3 align-middle",style:{"font-size":"1.5rem"}},null,-1),De={class:"align-middle",style:{"line-height":"1.5rem"}},ze=["href"],$e={key:1},Be=["href"],Le={key:3},Ee=["href"],Pe={class:"d-flex align-items-center mt-3"},Fe={class:"d-flex align-items-center me-4"},Ve={class:"align-middle",style:{"line-height":"1.5rem"}},je={class:"d-flex align-items-center me-3"},Re=e("i",{class:"bi bi-chat-square-text me-3 align-middle",style:{"font-size":"1.5rem"}},null,-1),Me={class:"align-middle",style:{"line-height":"1.5rem"}},Oe={class:"write-bar form-group"},Ne=e("label",{for:"comment-area",class:"mb-2"},"Komentēt: ",-1),Se={class:"d-flex align-items-center"},Te={class:"replies-bar"},qe=z({__name:"Publication",props:["postId"],setup(m){const o=m,a="https://harmony.northeurope.cloudapp.azure.com",{cookies:x}=E(),v=u(x.get("token")),t=u([]),k=u("user-photos/0/default.png"),_=u(!1),b=u(null),C=u(null),U=u(null);N(b,U,{src:a+"/api/"+t.value.mp3Url,lineColor:"#00b3ff"});const I=u([]),d=u("");let n={headers:{Authorization:"Bearer "+v.value}};function F(){let s=document.getElementById("canvas"+t.value.id);s.classList.add("d-block"),s.classList.remove("d-none")}function $(){let s=document.getElementById("canvas"+t.value.id);s.classList.add("d-none"),s.classList.remove("d-block")}S(()=>{let s=document.getElementById("plyrplay"+o.postId);s!=null&&(console.log("plyrplay"+o.postId),console.log(s),s.addEventListener("playing",()=>F()),s.addEventListener("pause",()=>$()),s.addEventListener("ended",()=>$()))});function D(){y.push({path:"/user/"+t.value.userId})}function V(){let s=g.decode(v.value).userId;h.get(a+"/api/posts/is-liked?postId="+o.postId+"&userId="+s,n).then(function(l){_.value=l.data}).catch(function(l){console.log(l)})}function j(){const s=new FormData;s.append("userId",g.decode(v.value).userId),s.append("postId",o.postId),h.post(a+"/api/posts/like",s,n).then(function(l){console.log(l.data),y.go(0)}).catch(function(l){console.log(l)})}function R(){const s=new FormData;s.append("userId",g.decode(v.value).userId),s.append("postId",o.postId),h.post(a+"/api/posts/unlike",s,n).then(function(l){console.log(l.data),y.go(0)}).catch(function(l){console.log(l)})}function B(){h.get(a+"/api/replies/get-all?postId="+o.postId,n).then(function(s){I.value=s.data,console.log(I.value)}).catch(function(s){console.log(s)})}P(()=>{h.get(a+"/api/posts/get-by-id?postId="+o.postId,n).then(function(s){t.value=s.data,t.value.avatarUrl!=null&&(k.value=t.value.avatarUrl),console.log(t.value)}).catch(function(s){console.log(s)}),V(),B()});function M(){const s=new FormData;s.append("content",d.value),s.append("userId",g.decode(v.value).userId),s.append("postId",o.postId),h.post(a+"/api/replies/publish",s,n).then(function(l){console.log(l.data),B(),d.value=""}).catch(function(l){console.log(l)})}return(s,l)=>{const O=T("vue-plyr");return i(),c("div",oe,[e("div",ne,[e("i",{class:"bi bi-arrow-left align-middle pointer",style:{"font-size":"1.5rem","margin-right":"10px"},onClick:l[0]||(l[0]=w=>f(y).push({path:"/"}))}),ae]),e("div",ie,[e("div",ce,[e("img",{src:f(a)+"/api/"+k.value,alt:"",width:"75",height:"75",class:"rounded-circle me-2 object-fit-cover pointer",onClick:D},null,8,de),e("div",re,[e("strong",{class:"pointer",onClick:D},p(t.value.name),1),e("div",{class:"align-items-center pointer",onClick:D},"@"+p(t.value.username),1)]),e("div",ue,p(t.value.createdDate),1)]),e("p",pe,p(t.value.content),1),t.value.mp3Url?(i(),c("div",me,[e("div",he,[e("div",ve,[L(O,{ref_key:"plyr",ref:C,id:"plyrplay"+o.postId},{default:q(()=>[e("audio",{ref_key:"player",ref:b,controls:"",crossorigin:"",playsinline:""},[e("source",{src:f(a)+"/api/"+t.value.mp3Url,type:"audio/mp3"},null,8,_e)],512)]),_:1},8,["id"])]),e("div",fe,[t.value.songMetadata?(i(),c("div",ge,ke)):r("",!0)])])])):r("",!0),t.value.songMetadata?(i(),c("div",be,[e("div",Ie,[e("p",xe,p(t.value.songMetadata),1)])])):r("",!0),e("canvas",{ref_key:"canvas",ref:U,id:"canvas"+o.postId,class:"d-none"},null,8,Ue),t.value.mp3Url||t.value.pdfUrl||t.value.midiUrl?(i(),c("div",we,[Ce,e("div",De,[t.value.mp3Url?(i(),c("a",{key:0,href:f(a)+"/api/"+t.value.mp3Url,class:"nav-link link-primary d-inline-block"},"mp3",8,ze)):r("",!0),t.value.mp3Url&&(t.value.pdfUrl||t.value.midiUrl)?(i(),c("span",$e," • ")):r("",!0),t.value.midiUrl?(i(),c("a",{key:2,href:f(a)+"/api/"+t.value.midiUrl,class:"nav-link link-primary d-inline-block"},"midi",8,Be)):r("",!0),t.value.midiUrl&&t.value.pdfUrl?(i(),c("span",Le," • ")):r("",!0),t.value.pdfUrl?(i(),c("a",{key:4,href:f(a)+"/api/"+t.value.pdfUrl,class:"nav-link link-primary d-inline-block"},"pdf",8,Ee)):r("",!0)])])):r("",!0),e("div",Pe,[e("div",Fe,[_.value?r("",!0):(i(),c("i",{key:0,class:"bi bi-heart me-3 align-middle pointer",style:{"font-size":"1.5rem"},onClick:j})),_.value?(i(),c("i",{key:1,class:"bi bi-heart-fill me-3 align-middle pointer",style:{"font-size":"1.5rem"},onClick:R})):r("",!0),e("span",Ve,p(t.value.likeCount),1)]),e("div",je,[Re,e("span",Me,p(t.value.replyCount),1)])])]),e("div",Oe,[Ne,e("div",Se,[A(e("textarea",{class:"form-control",id:"comment-area",rows:"3","onUpdate:modelValue":l[1]||(l[1]=w=>d.value=w)},null,512),[[X,d.value]]),e("button",{type:"submit",class:"btn btn-primary ms-3",style:{height:"60px"},onClick:M},"Submit")])]),(i(!0),c(J,null,K(I.value,w=>(i(),c("div",Te,[L(le,{reply:w},null,8,["reply"])]))),256))])}}});const Xe=z({__name:"PublicationView",setup(m){return(o,a)=>(i(),G(qe))}});export{Xe as default};
